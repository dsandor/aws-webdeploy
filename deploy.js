#!/usr/bin/env node
"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const cdk = require("@aws-cdk/core");
const aws_cdk_static_website_1 = require("aws-cdk-static-website");
class MyWebStack extends aws_cdk_static_website_1.StaticWebsiteStack {
    constructor(scope, id) {
        const props = {
            websiteDistPath: pkg.webdeploy.distPath,
            deploymentVersion: pkg.version,
            resourcePrefix: pkg.webdeploy.resourcePrefix,
            indexDocument: pkg.webdeploy.indexDocument,
        };
        super(scope, id, props);
    }
}
exports.MyWebStack = MyWebStack;
if (process.argv.length !== 3) {
    console.error('FAIL, please pass current working directory to command. E.g. "aws-webdeploy $(pwd)" in "scripts"');
    process.exit(1);
}
const workingPath = process.argv[2];
const pkg = require(`${workingPath}/package.json`);
console.log('pkg:', pkg);
if (!pkg.webdeploy) {
    console.error('Error, package.json should have a "webdeploy" configuration section.');
    process.exit(2);
}
const app = new cdk.App();
new MyWebStack(app, pkg.webdeploy.stackName || pkg.name);
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZGVwbG95LmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiZGVwbG95LnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7OztBQUlBLHFDQUFzQztBQUN0QyxtRUFBaUY7QUFFakYsTUFBYSxVQUFXLFNBQVEsMkNBQWtCO0lBQ2hELFlBQVksS0FBYyxFQUFFLEVBQVU7UUFDcEMsTUFBTSxLQUFLLEdBQXdCO1lBQ2pDLGVBQWUsRUFBRSxHQUFHLENBQUMsU0FBUyxDQUFDLFFBQVE7WUFDdkMsaUJBQWlCLEVBQUUsR0FBRyxDQUFDLE9BQU87WUFDOUIsY0FBYyxFQUFFLEdBQUcsQ0FBQyxTQUFTLENBQUMsY0FBYztZQUM1QyxhQUFhLEVBQUUsR0FBRyxDQUFDLFNBQVMsQ0FBQyxhQUFhO1NBQzNDLENBQUM7UUFFRixLQUFLLENBQUMsS0FBSyxFQUFFLEVBQUUsRUFBRSxLQUFLLENBQUMsQ0FBQztJQUMxQixDQUFDO0NBQ0Y7QUFYRCxnQ0FXQztBQUVELElBQUksT0FBTyxDQUFDLElBQUksQ0FBQyxNQUFNLEtBQUssQ0FBQyxFQUFFO0lBQzdCLE9BQU8sQ0FBQyxLQUFLLENBQUMsa0dBQWtHLENBQUMsQ0FBQztJQUNsSCxPQUFPLENBQUMsSUFBSSxDQUFDLENBQUMsQ0FBQyxDQUFDO0NBQ2pCO0FBRUQsTUFBTSxXQUFXLEdBQUcsT0FBTyxDQUFDLElBQUksQ0FBQyxDQUFDLENBQUMsQ0FBQztBQUNwQyxNQUFNLEdBQUcsR0FBRyxPQUFPLENBQUMsR0FBRyxXQUFXLGVBQWUsQ0FBQyxDQUFDO0FBRW5ELE9BQU8sQ0FBQyxHQUFHLENBQUMsTUFBTSxFQUFFLEdBQUcsQ0FBQyxDQUFDO0FBRXpCLElBQUksQ0FBQyxHQUFHLENBQUMsU0FBUyxFQUFFO0lBQ2xCLE9BQU8sQ0FBQyxLQUFLLENBQUMsc0VBQXNFLENBQUMsQ0FBQztJQUN0RixPQUFPLENBQUMsSUFBSSxDQUFDLENBQUMsQ0FBQyxDQUFDO0NBQ2pCO0FBRUQsTUFBTSxHQUFHLEdBQUcsSUFBSSxHQUFHLENBQUMsR0FBRyxFQUFFLENBQUM7QUFDMUIsSUFBSSxVQUFVLENBQUMsR0FBRyxFQUFFLEdBQUcsQ0FBQyxTQUFTLENBQUMsU0FBUyxJQUFJLEdBQUcsQ0FBQyxJQUFJLENBQUMsQ0FBQyIsInNvdXJjZXNDb250ZW50IjpbIiMhL3Vzci9iaW4vZW52IG5vZGVcbi8qXG5UT0RPOiBNYWtlIHRoaXMgdGFrZSBhbGwgdGhlIHBhcmFtZXRlcnMgZnJvbSB0aGUgcGFja2FnZS5qc29uLlxuKi9cbmltcG9ydCBjZGsgPSByZXF1aXJlKCdAYXdzLWNkay9jb3JlJyk7XG5pbXBvcnQgeyBTdGF0aWNXZWJzaXRlU3RhY2ssIElTdGF0aWNXZWJzaXRlUHJvcHMgfSBmcm9tICdhd3MtY2RrLXN0YXRpYy13ZWJzaXRlJztcblxuZXhwb3J0IGNsYXNzIE15V2ViU3RhY2sgZXh0ZW5kcyBTdGF0aWNXZWJzaXRlU3RhY2sge1xuICBjb25zdHJ1Y3RvcihzY29wZTogY2RrLkFwcCwgaWQ6IHN0cmluZyApIHtcbiAgICBjb25zdCBwcm9wczogSVN0YXRpY1dlYnNpdGVQcm9wcyA9IHtcbiAgICAgIHdlYnNpdGVEaXN0UGF0aDogcGtnLndlYmRlcGxveS5kaXN0UGF0aCxcbiAgICAgIGRlcGxveW1lbnRWZXJzaW9uOiBwa2cudmVyc2lvbixcbiAgICAgIHJlc291cmNlUHJlZml4OiBwa2cud2ViZGVwbG95LnJlc291cmNlUHJlZml4LFxuICAgICAgaW5kZXhEb2N1bWVudDogcGtnLndlYmRlcGxveS5pbmRleERvY3VtZW50LFxuICAgIH07XG5cbiAgICBzdXBlcihzY29wZSwgaWQsIHByb3BzKTtcbiAgfVxufVxuXG5pZiAocHJvY2Vzcy5hcmd2Lmxlbmd0aCAhPT0gMykge1xuICBjb25zb2xlLmVycm9yKCdGQUlMLCBwbGVhc2UgcGFzcyBjdXJyZW50IHdvcmtpbmcgZGlyZWN0b3J5IHRvIGNvbW1hbmQuIEUuZy4gXCJhd3Mtd2ViZGVwbG95ICQocHdkKVwiIGluIFwic2NyaXB0c1wiJyk7XG4gIHByb2Nlc3MuZXhpdCgxKTtcbn1cblxuY29uc3Qgd29ya2luZ1BhdGggPSBwcm9jZXNzLmFyZ3ZbMl07XG5jb25zdCBwa2cgPSByZXF1aXJlKGAke3dvcmtpbmdQYXRofS9wYWNrYWdlLmpzb25gKTtcblxuY29uc29sZS5sb2coJ3BrZzonLCBwa2cpO1xuXG5pZiAoIXBrZy53ZWJkZXBsb3kpIHtcbiAgY29uc29sZS5lcnJvcignRXJyb3IsIHBhY2thZ2UuanNvbiBzaG91bGQgaGF2ZSBhIFwid2ViZGVwbG95XCIgY29uZmlndXJhdGlvbiBzZWN0aW9uLicpO1xuICBwcm9jZXNzLmV4aXQoMik7XG59XG5cbmNvbnN0IGFwcCA9IG5ldyBjZGsuQXBwKCk7XG5uZXcgTXlXZWJTdGFjayhhcHAsIHBrZy53ZWJkZXBsb3kuc3RhY2tOYW1lIHx8IHBrZy5uYW1lKTsiXX0=